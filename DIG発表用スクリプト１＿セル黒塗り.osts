{"version":"0.3.0","body":"//基本的なOfficeスクリプト（TypeScript）コード一覧よりコードを取得して作成\n\nfunction main(workbook: ExcelScript.Workbook) {\n  // ====== 触るシートを指定（今回は「Before」）======\n  const sheet = workbook.getWorksheet(\"Before\");\n\n  // ====== データがどこまであるか（最終行）を探す ======\n  // 使われている範囲（UsedRange）がなければ何もしない\n  const used = sheet.getUsedRange();\n  if (!used) return;\n\n  // X列（件名）が入っている最終行を探して、データの終わりを決める\n  // ※X列は見出しで「件名」の列（この列が最後まで入っている前提）\n  // getRangeByIndexes(開始行,開始列,取得行数,取得列数)\n  //　⇒取得行数を得る”used.getRowCount()”を引数に追加\n  //　xValuesでxRangeの範囲(X列)のデータを取得（2次元配列　行×入力データ）\n  const xColIndex = 23; // X列=24列目 → 0始まりで23\n  const xRange = sheet.getRangeByIndexes(0, xColIndex, used.getRowCount(), 1);\n  const xValues = xRange.getValues();\n\n  let lastRow = 1; // Excelの最後の行番号（1始まり）i=0は見出し行なので除外\n    // 最後の行からカウントダウンループ\n  for (let i = xValues.length - 1; i >= 1; i--) { \n    // i行目の1列目の値を取り出して変数ｖに代入\n    const v = xValues[i][0];\n    // ｖが空欄でなければ行に値が入っていると判断\n    if (v !== null && v !== \"\") {\n      lastRow = i + 1; // iは0始まりなので1始まりへ変換。\n      //これで最後に値が入って言う行番号をLastRowにセット\n      break;\n      //最後に値が入っている行が見つかったのでループを終了\n    }\n  }\n\n // ====== 金額が安い案件の資料Ａ資料Ｂ列を黒塗りする ======\n  //====== ルール　======\n  // Z列（推定金額）が2000000未満なら、\n  // E列/F列（資料A/資料B）の「塗りつぶし色」を黒にする \n  for (let r = 2; r <= lastRow; r++) { // 2行目からデータ（1行目は見出し）\n    const zRaw = sheet.getRange(`Z${r}`).getValue();\n\n    // セルの値が「数値」でも「文字列」でも比較できるように数値化\n    const z = (typeof zRaw === \"number\") ? zRaw : parseFloat(String(zRaw));\n\n    // 数値に変換できない場合はスキップ（空欄や文字など）\n    if (isNaN(z)) continue;\n\n    if (z < 2000000) {\n      // getFont().setColor(...) → 文字色\n      // getFill().setColor(...) → 塗りつぶし（背景色）\n      sheet.getRange(`E${r}`).getFormat().getFill().setColor(\"black\");\n      sheet.getRange(`F${r}`).getFormat().getFill().setColor(\"black\");\n    }\n  }\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}